# A robust Bayesian methodology for damage localization in plate-like structures using ultrasonic guided-waves

一种使用超声导波在板状结构中进行损伤定位的稳健贝叶斯方法

## Abstract

> SHM methods for damage detection and localization in plate-like structures have typically relied on signal post-processing techniques applied to ultrasonic guided-waves. The time of flight is one of these signals features which has been extensively used by the SHM community for damage localization. One approach for obtaining the time of flight is by applying a particular time-frequency transform to capture the frequency and energy content of the wave at each instant of time. To this end, the selection of a suitable methodology for time-frequency transform among the many candidates available in the literature has typically relied on experience, or simply based on considerations about computational efficiency. In this paper, a full probabilistic method based on the Bayesian inverse problem is proposed to rigorously provide a robust estimate of the time of flight for each sensor independently. Then, the robust prediction is introduced as an input to the Bayesian inverse problem of damage localization. The results reveal that the proposed methodology is able to efficiently reconstruct the damage localization within a metallic plate without the need to assume a specific a priori time-frequency transform model.

用于板状结构的损伤检测与定位的SHM方法通常依赖于超声导波的信号后处理技术。飞行时间作为这些信号特征之一，已经被SHM社区广泛的应用于损伤定位。一种获得飞行时间的方法是通过应用特定的时频转换来捕获波在每个时刻的频率和能量<font color=red>(的含量)</font>。为此，在文献中很多研究者为时频转换选择一个合适的方法通常依赖于经验，或者仅仅是基于对计算效率的考虑。在本文中，提出了一种基于贝叶斯逆问题的全概率方法，以严格独立地为每个传感器提供飞行时间的稳健估计。然后，引入稳健预测作为损伤定位的贝叶斯逆问题的输入。结果表明，所提出的方法能够有效地重建金属板内的损伤定位，而无需假设特定的先验时频变换模型。

## Introduction

> Damage reconstruction and localization in plate-like structures using guided-waves based SHM have been mainly addressed using post-processing techniques applied to ultrasonic signals [1]. The exploration of large areas with a small attenuation [2] is one of the most remarkable characteristics that has led industries, such as the aerospace industry, to focus on guided-waves (e.g. the ‘‘PAMELA” system [3–5]). Other approaches that use acoustic-based SHM methods to localize damage in thin-walled structures are also available nowadays. These can be broadly classified into (1) passive sensing diagnostics (PSD) and (2) active sensing diagnostics (ASD) techniques. In contrast to PSD techniques, which are based on sensors in ‘‘listening-mode” (e.g., acoustic emission) [6–12], ASD techniques for plate-like structures emit ultrasonic waves that interact with the structure and are measured by sensors [13]. Sparse or phased-array sensors’ layouts are placed so that the structure is actively interrogated on demand, which confers higher accuracy and reliability [14]. Potential safety and economical implications in condition-based maintenance are extra-motivations for the use of this SHM technique.

使用基于导波的 SHM 在板状结构中的损伤重建和定位主要是使用应用于超声波信号的后处理技术来解决的 [^1]。探索具有小衰减的大区域 [^2] 是导致航空航天工业等行业关注导波的最显着特征之一 (例如“PAMELA”系统 [^3] [^4] [^5] )。现在也有其他使用基于声学的 SHM 方法来定位薄壁结构损伤的方法。这些可以大致分为 (1) 无源传感诊断技术 (PSD) 和 (2) 有源传感诊断技术 (ASD)。与基于<font color=red>“收听模式”</font> (例如声发射) [^6] [^7] [^8] [^9] [^10] [^11] [^12] 的传感器的 PSD 技术相比，用于板状结构的 ASD 技术会发射与结构相互作用并由传感器测量的超声波 [^13]。放置稀疏或相控阵传感器的布局，以便根据需要主动询问结构，从而提供更高的准确性和可靠性[^14]。在基于条件的维护中，潜在的安全和经济意义是使用这种SHM技术的额外动机。

> Moreover, the need for autonomous techniques that provide accurate health state indicators is specially crucial for aerospace structures, which are based on a considerable number of critical structural components requiring frequent inspection. Once a damaged area is detected, i.e. through analysis of damage tolerance exceedance, proper operational decisions can be taken. Two general approaches are typically adopted for damage detection: (1) model-based inverse problems, whereby detailed damage information (e.g. the severity of damage as residual strength) [15] can be obtained from the measured signal at a considerable computational cost; and (2) inverse problems based on post-processed signal features, whereby other relevant information, e.g. the damage position or the damage severity, can be obtained more efficiently. With regards to the second approach, several damage reconstruction techniques have been reported in the literature [2,16–18]. Among them, the time-of-flight (ToF) has been extensively used as a signal feature for its efficiency in obtaining information about material properties along with damage localization using post-processing scattered signals.

此外，对提供准确健康指标的自主技术的需求对航空航天结构尤为重要，因为这些结构基于大量需要需要频繁检查的关键结构部件。一旦检测到损坏区域，即通过分析损坏容限超出范围，就可以做出适当的操作决策。损伤检测通常采用两种通用方法: (1) 基于模型的逆问题，从而可以从测量信号中以相当大的计算成本获得详细的损伤信息 (例如，损坏的严重程度作为剩余强度) [^15]；(2) 基于后处理信号特征的逆问题，从而可以更有效地获取其他相关信息，例如损坏位置或损坏严重程度。关于第二种方法，文献中描述了几种损伤重建技术 [^2] [^16] [^17] [^18] 。其中，飞行时间 (ToF) 已被广泛用作一种信号特征，因为它可以有效地获取有关材料特性的信息以及随后处理散射信号进行损伤定位。

>Time-frequency (TF) representation techniques have been intensively used for the extraction of ToF as a signal feature. By TF representation, a frequency domain spectrum can be obtained at each instant of time [19], however the results slightly differ from each other depending on the adoption of the various approaches available in the literature. Amongst them, the Hilbert-Huang transform (HHT), the continuous wavelet transform (CWT), the short-time Fourier transform (STFT) and the Wigner-Ville distribution (WVD) [19–22], are some of the most commonly used techniques in ultrasonic guided-waves based SHM applications [23–25]. Typically, the selection of one among the available options has been based on the modeler’s experience or based on specific TF resolution characteristics. However, the selection of an unappropriated model may result in a biased damage identification [26,27] due to the disparate model assumptions and hypotheses adopted for each of them. In other words, the choice of a particular TF approach instead of another one is subject to epistemic uncertainty (i.e., lack of knowledge). Moreover, ultrasound-based damage localization conveys other sources of uncertainty which are mostly related with the measurement system and physical properties of the material. They might produce unreliable damage predictions should these uncertainties are not properly considered and quantified within the calculations.

时频 (TF) 表示技术已被广泛用于提取 ToF 作为信号特征。通过 TF 表示，可以在每个时刻获得频域频谱 [^19]，但是根据文献中可用的各种方法，彼此的结果略有不同。其中，Hilbert-Huang 变换 (HHT)、连续小波变换 (CWT)、短时傅里叶变换 (STFT) 和 Wigner-Ville 分布 (WVD) [^19] [^20] [^21] [^22] 是基于超声导波的 SHM 应用中最常用的一些技术 [^23] [^24] [^25]。通常，根据建模者的经验或基于特定的 TF 分辨率特征，从可用选项中选择一个。然而，由于模型假设和假设各不相同，选择不合适的模型可能会导致损害识别有偏差 [^26] [^27]。换句话说，选择特定的 TF 方法而不是另一种方法受认知不确定性的影响(例如，缺少知识)。此外，基于超声波的损伤定位还传达了其他不确定性来源，这些不确定性主要与测量系统和材料的物理特性有关。如果在计算中没有适当考虑和量化这些不确定性，它们可能会产生不可靠的损坏预测。

> To partially address this modeling issue, a number of researchers have proposed the use of probability-based methods [28–30]. Among them, the Bayesian inverse problem (BIP) applied to ultrasound based damage localization is getting increasing attention within the SHM community, although it is still in its early stage. In [24], the BIP was successfully proven in localizing damage areas in aluminum plates. More recently, a BIP methodology to account for the anisotropy in the group velocity was proposed in [23] for composite laminates. Notwithstanding, there is still an evident need for a rigorous treatment of the uncertainty in modeling the damage localization using ultrasonic guided-waves based methods, overall when multiple damage locations are expected.

为了部分解决这个建模问题，许多研究人员提出了使用基于概率的方法 [^28] [^29] [^30]。其中，应用于基于超声的损伤定位的贝叶斯逆问题（BIP）在 SHM 社区中越来越受到关注，尽管它仍处于早期阶段。在 [^24] 中，BIP 被成功地证明可以定位铝板的损伤区域。最近，在 [^23] 中提出了一种用于解释复合层压板的群速度各向异性的 BIP 方法。尽管如此，仍然明显的需要严格处理使用基于超声导波的方法来应对损伤定位进行建模时的不确定性，总体而言，当预计会有多个损伤位置时。

> This paper proposes a multi-level Bayesian framework to rigorously account for the overall uncertainty in application to the problem of ultrasound-based damage localization using Lamb waves. The main novelty of this paper is that it provides a unified methodology to rationally address the problem of damage identification using ultrasounds from probabilistic Bayesian principles: first, the problem of TF model selection is addressed for a given experimental configuration based on posterior probabilities that assess the relative degree of belief [31] of a particular model over a set of candidates; then, the problem of damage identification and localization is carried out using a BIP based on signal features adopting a hyper-robust TF model resulted from the first assessment level. To this end, once the raw data have been acquired, two BIPs are hierarchically formulated for each piezoelectric (PZT) sensor so that the outcome of the model selection problem is used as input for damage localization, as shown in Fig. 1. In this framework, uncertainties coming from (1) material’s mechanical properties, (2) measurement errors, and (3) epistemic uncertainty in the TF model due to the Heisenberg principle [19,30], are taken into account. The proposed approach relies on rigorous probability-logic assumptions for model class selection [32] and as such, it avoids experience-based decisions about the optimal post-processing technique. Here, probability is interpreted as a multi-valued logic that expresses the degree of belief of a proposition conditioned on the given information [33,32]. The methodology is applied in two case studies using aluminum plates with one and two damaged areas, respectively. For the particular problem of damage localization, the asymptotic independent Markov sampling (AIMS) [34,35] algorithm is adopted to solve the resulting Bayesian inverse problem, showing high efficiency in dealing with damage multi-modality. In general, the results show the efficiency of the proposed methodology in reconstructing the damage position in platelike structures using guided-waves, while rigorously accounting for the modeling uncertainties in the reconstruction.

本文提出了一个多层次的贝叶斯框架，以严格解释应用兰姆波基于超声的损伤定位问题的整体不确定性。首先，基于后验概率的给定实验配置解决了 TF 模型选择问题，后验概率评估特定模型在一组候选上的相对置信度 [^31]；然后，使用基于信号特征的 BIP 进行损伤识别和定位问题，该模型采用来自第一评估级别的超稳健 TF 模型。为此，一旦获取了原始数据，就会为每个压电 (PZT) 传感器分层制定两个 BIP，以便将模型选择问题的结果用作损伤定位的输入，如图 1 所示。在这个框架中，由于海森堡原理 [^19] [^30]，来自 (1) 材料的机械性能、(2) 测量误差和 (3) TF 模型中的海森堡原理造成的认知不确定性的不确定性被考虑在内。所提出的方法依赖于模型类选择的严格概率逻辑假设 [^32]，因此，它避免了基于经验的关于最佳后处理技术的决策。在这里，概率被解释为一种多值逻辑，它表示以给定信息为条件的命题的可信度 [^33] [^32]。该方法应用于两个案例研究，分别使用具有一个和两个损坏区域的铝板。针对损伤定位的特殊问题，采用渐近独立马尔可夫采样 (AIMS) [^34,35] 算法来解决由此产生的贝叶斯逆问题，在处理损伤多模态方面表现出较高的效率。总的来说，结果显示了所提出的方法在使用导波重建板状结构中的损伤位置方面的高效性，同时严格考虑了重建中的建模不确定性。

<img src="论文翻译.assets/fig1.png" style="zoom: 100%" />


> The remainder of the paper is organized as follows: Section 2 shows the TF models used in the proposed model selection problem. Section 3 comprises the probabilistic methodology used to obtain the robust estimate of the ToF for each sensor. The BIP principles used to obtain the damage localization are presented in Section 4. In Section 5, the proposed framework is applied in two case studies to serve as example. Section 6 discusses the robustness of the proposed methodology. Finally, Section 7 provides concluding remarks.

在本文的其余部分安排如下：第 2 节展示了模型选择问题中使用的 TF 模型。第 3 节包含用于获得每个传感器的 ToF 的稳健估计的概率方法。第 4 节介绍了用于获得损伤定位的 BIP 原理。第 5 节中提出的框架应用于两个案例研究以作为示例。第 6 节讨论了所提出方法的稳健性。最后，第 7 节提供了结论性意见。

## Time-frequency models

>Among the most used TF models in the literature, four of them are selected in this paper to be assessed and ranked using the proposed Bayesian methodology for each sensor, independently; namely the HHT, CWT, STFT, and WVD. The main formulation of these TF representation techniques is shown in the following subsections.

本文选择了4个在文献中最常用的 TF 模型，使用所提出的贝叶斯方法对每个传感器独立进行评估和排序； 即 HHT、CWT、STFT 和 WVD。这些 TF 表示技术的主要公式显示在如下小节中。

### Hilbert-Huang transform

> The HHT is obtained by the sum of intrinsic mode functions (IMF) whereby the spectrum is defined after performing the Hilber transform over each IMF component [20,26], as follows:

HHT 是通过固有模式函数 (IMF) 的总和获得的，由此在对每个 IMF 分量执行 Hilber 变换后定义频谱 [^20] [^26]，如下所示：

$$
g_{i}\left( t\right) =\sum ^{n}_{j=1}\alpha _{j}\left( t\right) \exp \left( i\int \omega _{j}\left( t\right) dt\right) 
\tag{1}
$$

> where $ \alpha _{j}\left( t\right) $ is the magnitude of the analytic signal which is typically considered as the envelope of the input time series or directly the signal acquired by the sensor, $ n $ is the number of IMF components, and $ \omega _{j}\left( t\right) $ is the instantaneous frequency.Eq. (1) represents the amplitude and instantaneous frequency as function of time.

其中 $ \alpha _{j}\left( t\right) $ 是解析信号的幅度，通常被认为是输入时间序列的包络或直接被传感器获取的信号，$ n $ 是数字 IMF 分量，$ \omega _{j}\left( t\right) $ 是瞬时频率。方程 (1) 表示作为时间函数的幅度和瞬时频率。

### Continuous wavelet transform

> TF wavelets are used in the CWT to obtain the TF representation of the assessed signal, by:

TF 小波在 CWT 中用于获得评估信号的 TF 表示，方法是：

$$
g_{2}\left( b,a\right) =\dfrac{1}{\sqrt{a}}\int ^{\infty }_{-\infty }X\left( t\right) \overline{\Psi \left( \dfrac{t-b}{a}\right) dt}
\tag{2}
$$

> where $ X\left( t\right) $ represents the time series of the signal, $ \Psi \left( t\right) $ denotes the analysing wavelet, $ a > 0 $ is the scale factor, $ b $ is the timeshift variable, and the overline denotes the complex conjugate [21,36].  Remarkable time and frequency resolution are obtained using this model.

其中 $ X\left( t\right) $ 表示信号的时间序列， $ \Psi \left( t\right) $ 表示分析小波， $ a > 0 $ 是缩放因子， $ b $ 是时移因子，上划线表示复共轭 [^21] [^36]。使用该模型获得了显着的时间和频率分辨率。 

### Short-time Fourier transform

> Alternatively, the TF representation can be obtained with a STFT, which performs Fourier transforms to a moving window in the assessed signal [19,37], as follows:

或者，可以使用 STFT 表示 TF，该 STFT 对评估信号中的移动窗口执行傅里叶变换 [^19] [^37]，如下所示：

$$
g_{3}\left( \omega ,t\right) =\dfrac{1}{2\pi }\int _{-\infty }^{\infty }e^{-i\omega t}X\left( \tau \right) h\left( \tau -t\right) d\tau
\tag{3}
$$

> where $ X\left( t\right) $ is the time series, $ h\left( t\right) $ a window function, and \omega denotes the frequency. The energy spectrum of an STFT is known as a spectrogram.

其中 $ X\left( t\right) $ 是时间序列， $ h\left( t\right) $ 是窗口函数， $ \omega $ 表示频率。STFT 的能谱称为谱图。

### Wigner-Ville distribution

> The WVD can be interpreted as a measure of the signal’s local time-frequency energy [37], and it is defined as follows:

WVD 可以解释为信号本地时频能量的量度 [^37]，其定义如下：

$$
g_{4}\left( \omega ,t\right) =\int _{-\infty }^{\infty }X\left( t+\dfrac{\tau }{2}\right) \overline{X\left( t-\dfrac{\tau }{2}\right) }e^{-i\omega t}d\tau
\tag{4}
$$

> where $ X\left( t\right) $ is the time series and the overline denotes the complex conjugate. This technique is highly effective in detecting and localizing Dirac impulses and sinusoids [19,37].

其中 $ X\left( t\right) $ 是时间序列，上划线表示复共轭。 这种技术在检测和定位狄拉克脉冲和正弦曲线方面非常有效 [^19] [^37]。

##  Bayesian model class ranking

> The TF models in Section 2 are just different alternatives based on a number of simplifying hypotheses and modeling assumptions to represent the same reality. Instead, for a particular model, the validity of such simplifying assumptions depends on the adopted values of certain model parameters (e.g. the dispersion parameter). Thus, to simultaneously identify both the plausibility of each TF model and the values of the model parameters that better suit the information coming from the raw ultrasonic data, a Bayesian inverse problem (BIP) is proposed here. Given a plate-like structure monitored through a set of PZT sensors, the BIP is addressed separately for each PZT sensor due to the potential differences between sensors, such as different working environments or manufacturing defects.

第 2 节中的 TF 模型只是基于许多简化假设和建模假设的不同可选方案以表示现实中的相同情况。相反，对于特定模型，这种简化假设的有效性取决于某些模型参数的采用值 (例如色散参数)。因此，为了同时识别每个 TF 模型的合理性和更适合来自原始超声数据的信息的模型参数值，提出了贝叶斯逆问题 (BIP)。给定通过一组 PZT 传感器监控的板状结构，由于传感器之间的电位差异，例如不同的工作环境或制造缺陷，BIP 将针对每个 PZT 传感器单独处理。

###  Stochastic embedding of TF models

> Let us consider a candidate TF model defined by the relationship $ g_{j} $ : $ \mathbb{R}^{n} \to \mathbb{R} $ between a discrete signal $ \mathcal{D}^{(k)} \in \mathbb{R}^{n} $ acting as input and the model output $ g_{j} \in \mathbb{R}^{n} $, where k denotes the k-th sensor in the structure. Next, let $ \widehat{d}^{(k)}_{j} $ be the first energy peak observed in the scattered ultrasound signal, so that $ \widehat{d}^{(k)}_{j} = g_{j}(\mathcal{D}^{(k)}) $. Under the assumption that $ g_{j} $ is only a candidate model over a set of alternatives [^32] (e.g. like those described in Section 2), then the measured first peak, denoted here as $ \widetilde{d}^{(k)} $, would be more rigorously represented as an uncertain variable, as follows:

让我们考虑一个由关系 $ g_{j} $ 定义的候选 TF 模型： $ \mathbb{R}^{n} \to \mathbb{R} $ 在离散信号 $ \mathcal{D}^{(k )} \in \mathbb{R}^{n} $ 作为输入和模型输出 $ g_{j} \in \mathbb{R}^{n} $，其中 k 表示结构中的第 k 个传感器 . 接下来，令$ \widehat{d}^{(k)}_{j} $ 为散射超声信号中观察到的第一个能量峰值，使得$ \widehat{d}^{(k)}_{j} = g_{j}(\mathcal{D}^{(k)}) $. 假设 $ g_{j} $ 只是一组备选方案 [^32] 上的候选模型（例如，如第 2 节中描述的那些），那么测量的第一个峰值，这里表示为 $ \widetilde{d}^ {(k)} $，将更严格地表示为不确定变量，如下所示：

$$
\widehat{d}^{(k)}_{j} = g_{j}(\mathcal{D}^{(k)}) + \varepsilon
\tag{5}
$$

> where $ \varepsilon $ is an uncertain error term which accounts for the discrepancy between $ \widehat{d}^{(k)}_{j} $ and $ \widetilde{d}^ {(k)} $, namely the modeled and measured values for the first energy peak, respectively. Following the Principle of Maximum Information Entropy (PMIE) [^32][^33], this error can be conservatively assumed to be modeled as a zero-mean Gaussian distribution with standard deviation $ \sigma_{\varepsilon} $, i.e., $ \sigma \sim \mathcal{N}(0, \sigma_{\varepsilon})  $. The PMIE enables a rational way to establish a probability model for the model error term such that it produces the largest uncertainty (largest Shannon entropy); the selection of any other probability model would lead to an unjustified reduction in such uncertainty [^32]. Thus, following Eq. (5), a probabilistic description of the TF model can be obtained as:

其中 $ \varepsilon $ 是一个不确定的误差项，它解释了 $ \widehat{d}^{(k)}_{j} $ 和 $ \widetilde{d}^ {(k)} $ 之间的差异，即 分别为第一个能量峰值的建模和测量值。 遵循最大信息熵原理（PMIE）[^32][^33]，可以保守地假设这个误差被建模为标准差为$\sigma_{\varepsilon}$的零均值高斯分布，即$ \sigma \sim \mathcal{N}(0, \sigma_{\varepsilon}) $. PMIE 能够以合理的方式为模型误差项建立概率模型，使其产生最大的不确定性（最大的香农熵）； 选择任何其他概率模型都会导致这种不确定性的不合理减少 [^32]。 因此，遵循方程式。 （5），TF模型的概率描述可以得到：